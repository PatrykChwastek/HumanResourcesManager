{"ast":null,"code":"import APIURL from './Globals';\n\nconst login = loginData => {\n  const requestOptions = {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify(loginData)\n  };\n  return fetch(APIURL + 'users/login', requestOptions).then(response => {\n    if (response.ok) return response.json();else return Promise.reject();\n  }).then(data => {\n    localStorage.setItem(\"user\", JSON.stringify(data));\n  });\n};\n\nexport const logout = () => {\n  localStorage.removeItem(\"user\");\n};\nexport const getCurrentUser = () => {\n  return JSON.parse(localStorage.getItem(\"user\"));\n};\nexport const authHeader = () => {\n  const user = JSON.parse(localStorage.getItem('user'));\n\n  if (user && user.token) {\n    return 'Bearer ' + user.token;\n  } else {\n    return {};\n  }\n};\nexport const getUserAccess = () => {\n  if (getCurrentUser() === null) {\n    return null;\n  }\n\n  const permissions = getCurrentUser().userDetails.employeeDTO.permissions;\n\n  if (permissions === undefined || permissions.length < 1) {\n    return false;\n  }\n\n  const isUsserPermit = premName => {\n    let isPermit = false;\n    permissions.forEach(element => {\n      if (element.name === premName) {\n        isPermit = true;\n        return;\n      }\n    });\n    return isPermit;\n  };\n\n  let allowedViews = {\n    humanResources: isUsserPermit(\"Human-Resources\"),\n    admin: isUsserPermit('Admin'),\n    teamManager: isUsserPermit('Team-Manager')\n  };\n\n  if (allowedViews.admin) {\n    allowedViews = {\n      humanResources: true,\n      admin: true,\n      teamManager: true\n    };\n  }\n\n  return allowedViews;\n}; // eslint-disable-next-line\n\nexport default {\n  login,\n  logout,\n  getCurrentUser,\n  authHeader,\n  getUserAccess\n};","map":{"version":3,"sources":["C:/Users/Komputer/source/repos/HumanResourcesManager/human-resources-manager-client/src/Services/AuthService.js"],"names":["APIURL","login","loginData","requestOptions","method","headers","body","JSON","stringify","fetch","then","response","ok","json","Promise","reject","data","localStorage","setItem","logout","removeItem","getCurrentUser","parse","getItem","authHeader","user","token","getUserAccess","permissions","userDetails","employeeDTO","undefined","length","isUsserPermit","premName","isPermit","forEach","element","name","allowedViews","humanResources","admin","teamManager"],"mappings":"AAAA,OAAOA,MAAP,MAAmB,WAAnB;;AAEA,MAAMC,KAAK,GAAIC,SAAD,IAAe;AACzB,QAAMC,cAAc,GAAG;AACnBC,IAAAA,MAAM,EAAE,MADW;AAEnBC,IAAAA,OAAO,EAAE;AAAE,sBAAgB;AAAlB,KAFU;AAGnBC,IAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAeN,SAAf;AAHa,GAAvB;AAKA,SAAOO,KAAK,CAACT,MAAM,GAAG,aAAV,EAAyBG,cAAzB,CAAL,CACFO,IADE,CACIC,QAAD,IAAc;AAChB,QAAIA,QAAQ,CAACC,EAAb,EACI,OAAOD,QAAQ,CAACE,IAAT,EAAP,CADJ,KAGI,OAAOC,OAAO,CAACC,MAAR,EAAP;AACP,GANE,EAOFL,IAPE,CAOGM,IAAI,IAAI;AACVC,IAAAA,YAAY,CAACC,OAAb,CAAqB,MAArB,EAA6BX,IAAI,CAACC,SAAL,CAAeQ,IAAf,CAA7B;AACH,GATE,CAAP;AAUH,CAhBD;;AAkBA,OAAO,MAAMG,MAAM,GAAG,MAAM;AACxBF,EAAAA,YAAY,CAACG,UAAb,CAAwB,MAAxB;AACH,CAFM;AAIP,OAAO,MAAMC,cAAc,GAAG,MAAM;AAChC,SAAOd,IAAI,CAACe,KAAL,CAAWL,YAAY,CAACM,OAAb,CAAqB,MAArB,CAAX,CAAP;AACH,CAFM;AAIP,OAAO,MAAMC,UAAU,GAAG,MAAM;AAC5B,QAAMC,IAAI,GAAGlB,IAAI,CAACe,KAAL,CAAWL,YAAY,CAACM,OAAb,CAAqB,MAArB,CAAX,CAAb;;AAEA,MAAIE,IAAI,IAAIA,IAAI,CAACC,KAAjB,EAAwB;AACpB,WAAO,YAAYD,IAAI,CAACC,KAAxB;AACH,GAFD,MAEO;AACH,WAAO,EAAP;AACH;AACJ,CARM;AAUP,OAAO,MAAMC,aAAa,GAAG,MAAM;AAE/B,MAAIN,cAAc,OAAO,IAAzB,EAA+B;AAC3B,WAAO,IAAP;AACH;;AAED,QAAMO,WAAW,GAAGP,cAAc,GAAGQ,WAAjB,CAA6BC,WAA7B,CAAyCF,WAA7D;;AACA,MAAIA,WAAW,KAAKG,SAAhB,IAA6BH,WAAW,CAACI,MAAZ,GAAqB,CAAtD,EAAyD;AACrD,WAAO,KAAP;AACH;;AACD,QAAMC,aAAa,GAAIC,QAAD,IAAc;AAChC,QAAIC,QAAQ,GAAG,KAAf;AACAP,IAAAA,WAAW,CAACQ,OAAZ,CAAoBC,OAAO,IAAI;AAC3B,UAAIA,OAAO,CAACC,IAAR,KAAiBJ,QAArB,EAA+B;AAC3BC,QAAAA,QAAQ,GAAG,IAAX;AACA;AACH;AACJ,KALD;AAMA,WAAOA,QAAP;AACH,GATD;;AAWA,MAAII,YAAY,GAAG;AACfC,IAAAA,cAAc,EAAEP,aAAa,CAAC,iBAAD,CADd;AAEfQ,IAAAA,KAAK,EAAER,aAAa,CAAC,OAAD,CAFL;AAGfS,IAAAA,WAAW,EAAET,aAAa,CAAC,cAAD;AAHX,GAAnB;;AAMA,MAAIM,YAAY,CAACE,KAAjB,EAAwB;AACpBF,IAAAA,YAAY,GAAG;AACXC,MAAAA,cAAc,EAAE,IADL;AAEXC,MAAAA,KAAK,EAAE,IAFI;AAGXC,MAAAA,WAAW,EAAE;AAHF,KAAf;AAKH;;AACD,SAAOH,YAAP;AACH,CAnCM,C,CAqCP;;AACA,eAAe;AACXtC,EAAAA,KADW;AAEXkB,EAAAA,MAFW;AAGXE,EAAAA,cAHW;AAIXG,EAAAA,UAJW;AAKXG,EAAAA;AALW,CAAf","sourcesContent":["import APIURL from './Globals'\r\n\r\nconst login = (loginData) => {\r\n    const requestOptions = {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify(loginData)\r\n    };\r\n    return fetch(APIURL + 'users/login', requestOptions)\r\n        .then((response) => {\r\n            if (response.ok)\r\n                return response.json();\r\n            else\r\n                return Promise.reject();\r\n        })\r\n        .then(data => {\r\n            localStorage.setItem(\"user\", JSON.stringify(data))\r\n        })\r\n};\r\n\r\nexport const logout = () => {\r\n    localStorage.removeItem(\"user\");\r\n};\r\n\r\nexport const getCurrentUser = () => {\r\n    return JSON.parse(localStorage.getItem(\"user\"));\r\n};\r\n\r\nexport const authHeader = () => {\r\n    const user = JSON.parse(localStorage.getItem('user'));\r\n\r\n    if (user && user.token) {\r\n        return 'Bearer ' + user.token;\r\n    } else {\r\n        return {};\r\n    }\r\n}\r\n\r\nexport const getUserAccess = () => {\r\n\r\n    if (getCurrentUser() === null) {\r\n        return null;\r\n    }\r\n\r\n    const permissions = getCurrentUser().userDetails.employeeDTO.permissions;\r\n    if (permissions === undefined || permissions.length < 1) {\r\n        return false;\r\n    }\r\n    const isUsserPermit = (premName) => {\r\n        let isPermit = false;\r\n        permissions.forEach(element => {\r\n            if (element.name === premName) {\r\n                isPermit = true;\r\n                return;\r\n            }\r\n        });\r\n        return isPermit;\r\n    }\r\n\r\n    let allowedViews = {\r\n        humanResources: isUsserPermit(\"Human-Resources\"),\r\n        admin: isUsserPermit('Admin'),\r\n        teamManager: isUsserPermit('Team-Manager')\r\n    };\r\n\r\n    if (allowedViews.admin) {\r\n        allowedViews = {\r\n            humanResources: true,\r\n            admin: true,\r\n            teamManager: true\r\n        }\r\n    }\r\n    return allowedViews;\r\n}\r\n\r\n// eslint-disable-next-line\r\nexport default {\r\n    login,\r\n    logout,\r\n    getCurrentUser,\r\n    authHeader,\r\n    getUserAccess\r\n};"]},"metadata":{},"sourceType":"module"}